<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <!--[if lte IE 9]><meta http-equiv="refresh" content="0;url=/ie.html"><![endif]-->

    <title>Android Environment</title>
    <meta name="description" content="">
    <link rel="icon" type="image/png" href="/assets/img/favicon.png" />
    <link rel="stylesheet" type="text/css" href="/assets/css/style.css">
  </head>
  <body>
    <aside id="sidebar">
      <nav id="tags">
        <a href="/index.html" id="avatar"></a>

        <ul id="tags__ul">
          <li id="js-label1" class="tags__li tags-btn active">全部</li>
          <li id="js-label2" class="tags__li tags-btn">技术</li>
          <li id="js-label3" class="tags__li tags-btn">生活</li>
          <li id="js-label4" class="tags__li tags-btn">读书</li>
          <li id="js-label5" class="tags__li tags-btn">收藏</li>
          <li id="js-label6" class="tags__li tags-btn">关于</li>
        </ul>

        <div id="tags__bottom">
          <a href="mailto:zhanghao19930820@163.com" id="icon-email" class="tags-btn fontello"></a>
          <a href="/rss.xml" id="icon-feed" class="tags-btn fontello"></a>
        </div>
      </nav> <!-- end #tags -->

      <div id="posts-list">
        <form action="" id="search-form">
          <a href="/index.html" id="mobile-avatar"></a>

          <div style="padding: 20px 20px 20px; font-size: 18px;font-family: inherit; color: #1B813F;
">/* 你是你自己的导师 */</div>
        </form>

        <nav id="pl__container">
        
          <a class="technology pl__all" href="/technology/2015/04/07/blog.html"><span class="pl__circle"></span><span class="pl__title">个人独立博客搭建</span><span class="pl__date">Apr 2015</span></a>
        
          <a class="like pl__all" href="/like/2015/03/08/like-list-move.html"><span class="pl__circle"></span><span class="pl__title">喜欢的项目</span><span class="pl__date">Mar 2015</span></a>
        
          <a class="life pl__all" href="/life/2015/03/08/life.html"><span class="pl__circle"></span><span class="pl__title">生活</span><span class="pl__date">Mar 2015</span></a>
        
          <a class="about pl__all" href="/about/2015/03/08/about-me.html"><span class="pl__circle"></span><span class="pl__title">有关于我</span><span class="pl__date">Mar 2015</span></a>
        
          <a class="about pl__all" href="/about/2015/03/08/about-blogText.html"><span class="pl__circle"></span><span class="pl__title">博客标签测试模板</span><span class="pl__date">Mar 2015</span></a>
        
          <a class="technology pl__all" href="/technology/2015/03/08/Android-Environment.html"><span class="pl__circle"></span><span class="pl__title">Android Environment</span><span class="pl__date">Mar 2015</span></a>
        
          <a class="read pl__all" href="/read/2014/01/01/book-list-of-2014.html"><span class="pl__circle"></span><span class="pl__title">2015阅读书单</span><span class="pl__date">Jan 2014</span></a>
        
        </nav>
      </div> <!-- end #posts-list -->
    </aside> <!-- end #sidebar -->

    <div id="post">
      <div id="pjax">
        <!--这个页面是喜欢的应用页面 like -->
<article id="post__content">
  <h1 id="post__title" data-identifier="20150308">Android Environment</h1>
  <h3 id="environment">Environment类</h3>

<p>Android应用开发中，常使用Environment类去获取外部存储目录，在访问外部存储之前一定要先判断外部存储是否已经是可使用（已挂载&amp;可使用）状态,</p>

<p>并且需要在AndroidManifest.xml文件中添加外部存储读和写的权限。</p>

<font style="color:red">context.getCacheDir() </font>
<p>获取应用程序自己的缓存目录</p>

<font style="color:red">context.getExternalCacheDir()  </font>
<p>获取应用程序在外部存储的存储目录</p>

<p>Environment类中提供了几个静态常量用于标识外部存储的状态，这些状态都是String类型</p>

<p>MEDIA_BAD_REMOVAL 在没有挂载前存储媒体已经被移除。</p>

<p>MEDIA_CHECKING 正在检查存储媒体。</p>

<p>MEDIA_MOUNTED 存储媒体已经挂载，并且挂载点可读/写。</p>

<p>MEDIA_MOUNTED_READ_ONLY 存储媒体已经挂载，挂载点只读。</p>

<p>MEDIA_NOFS 存储媒体是空白或是不支持的文件系统。</p>

<p>MEDIA_REMOVED 存储媒体被移除。</p>

<p>MEDIA_SHARED 存储媒体正在通过USB共享。</p>

<p>MEDIA_UNMOUNTABLE 存储媒体无法挂载。</p>

<p>MEDIA_UNMOUNTED 存储媒体没有挂载。</p>

<p>可以通过静态方法getExternalStorageState()来获取外部存储的状态，如果程序需要在外部存储里面读写数据，必须要先判断：</p>

<table>
  <tbody>
    <tr>
      <td>if(Environment.MEDIA_MOUNTED.equals(Environment.getExternalStorageState())</td>
      <td> </td>
      <td>!Environment.isExternalStorageRemovable())</td>
    </tr>
  </tbody>
</table>

<p>然后，添加外部存储读和写的权限:</p>

<uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE">

<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"></uses-permission></uses-permission>

<p>在Environment中还提供了Android标准目录的路径，以String类型提供。
DIRECTORY_ALARMS 系统提醒铃声存放的标准目录。</p>

<p>DIRECTORY_DCIM 相机拍摄照片和视频的标准目录。</p>

<p>DIRECTORY_DOWNLOADS 下载的标准目录。</p>

<p>DIRECTORY_MOVIES 电影存放的标准目录。</p>

<p>DIRECTORY_MUSIC 音乐存放的标准目录。</p>

<p>DIRECTORY_NOTIFICATIONS 系统通知铃声存放的标准目录。</p>

<p>DIRECTORY_PICTURES 图片存放的标准目录</p>

<p>DIRECTORY_PODCASTS 系统广播存放的标准目录。</p>

<p>DIRECTORY_RINGTONES 系统铃声存放的标准目录。</p>

<p>static File getDataDirectory() 获得data的目录（/data）。
static File getDownloadCacheDirectory() 获得下载缓存目录。（/cache）
static File getExternalStorageDirectory() 获得外部存储媒体目录。（/mnt/sdcard or /storage/sdcard0）
static File getRootDirectory() 获得系统主目录（/system）</p>

<p>除了用Environment获取存储目录之外，还可以通过把路径写死的方式，比如要读取外部存储/mnt/sdcard目录下的文件，可以在程序中直接用全路径，
但是这样做是很不好的，应该Android实在是太开放了，外部存储的目录的什么还是要固件制作商才知道，但是有一点是毋庸置疑的，就是Android框架层里面
已经是指定好了Environment.getDownloadCacheDirectory()的返回路径。所以，尽量用这种方式来获取和存储数据，以免固件厂商不同而造成路径的差异。</p>

<p>Android的实际开发中还用了两个非常重要的缓存目录，一个是应用程序自己的缓存空间，另一个是外部存储为该应该程序提供的缓存空间。有什么差别？</p>

<p>使用过LruCache和DisLruCache的童鞋应该知道。</p>

<p>这两个方法是通过上下文对象Context获取的，只要应用程序被卸载，这两个目录下的文件都要被清空。</p>


</article> <!-- end #post__content -->

<div id="post__share">
  <a id="icon-twitter" class="fontello" href="https://twitter.com/intent/tweet?url=http://zhenchen.me//technology/2015/03/08/Android-Environment.html&text=Android Environment" target="_blank"></a>
  <a id="icon-cc" class="fontello" href="http://creativecommons.org/licenses/by-nc-sa/3.0" target="_blank"></a>
  <a id="icon-weibo" class="fontello" href="http://v.t.sina.com.cn/share/share.php?url=http://zhenchen.me//technology/2015/03/08/Android-Environment.html&title=Android Environment" target="_blank"></a>
</div> <!-- end #post__share -->

<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'zhangxiaohao'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    

<p id="copyright">Powered by <a href="http://jekyllrb.com" target="_blank">Jekyll</a>&nbsp;&nbsp;|&nbsp;&nbsp;Theme <a href="https://github.com/P233/3-Jekyll" target="_blank">3-Jekyll</a></p>

      </div> <!-- end #pjax -->

      <div id="post__toc-trigger">
        <div id="post__toc">
          <span id="post__toc-title">Table of Contents</span>
          <ul id="post__toc-ul"></ul>
        </div>
      </div>
    </div> <!-- end #post -->

    <button id="js-fullscreen"><span id="icon-arrow" class="fontello"></span></button>

    <script src="/assets/js/jquery-2.0.3.min.js"></script>
    <script src="/assets/js/jquery.pjax.js"></script>
    <script src="/assets/js/nprogress.js"></script>
    <script src="/assets/js/script.js"></script>
    <script type="text/javascript">
    var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
    document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F8df9f41c154d89488e1b1cc18038ab8f' type='text/javascript'%3E%3C/script%3E"));
</script>

  </body>
</html>
