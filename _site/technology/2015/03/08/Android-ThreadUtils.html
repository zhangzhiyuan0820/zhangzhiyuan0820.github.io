<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <!--[if lte IE 9]><meta http-equiv="refresh" content="0;url=/ie.html"><![endif]-->

    <title>Android ThreadUtils</title>
    <meta name="description" content="">
    <link rel="icon" type="image/png" href="/assets/img/favicon.png" />
    <link rel="stylesheet" type="text/css" href="/assets/css/style.css">
  </head>
  <body>
    <aside id="sidebar">
      <nav id="tags">
        <a href="/index.html" id="avatar"></a>

        <ul id="tags__ul">
          <li id="js-label1" class="tags__li tags-btn active">全部</li>
          <li id="js-label2" class="tags__li tags-btn">技术</li>
          <li id="js-label3" class="tags__li tags-btn">生活</li>
          <li id="js-label4" class="tags__li tags-btn">读书</li>
          <li id="js-label5" class="tags__li tags-btn">收藏</li>
          <li id="js-label6" class="tags__li tags-btn">关于</li>
        </ul>

        <div id="tags__bottom">
          <a href="mailto:zhanghao19930820@163.com" id="icon-email" class="tags-btn fontello"></a>
          <a href="/rss.xml" id="icon-feed" class="tags-btn fontello"></a>
        </div>
      </nav> <!-- end #tags -->

      <div id="posts-list">
        <form action="" id="search-form">
          <a href="/index.html" id="mobile-avatar"></a>

          <div style="padding: 20px 20px 20px; font-size: 18px;font-family: inherit; color: #1B813F;
">/* 你是你自己的导师 */</div>
        </form>

        <nav id="pl__container">
        
          <a class="technology pl__all" href="/technology/2015/04/26/Android-SameTitle.html"><span class="pl__circle"></span><span class="pl__title">Android同样的标题</span><span class="pl__date">Apr 2015</span></a>
        
          <a class="life pl__all" href="/life/2015/04/14/main-life.html"><span class="pl__circle"></span><span class="pl__title">2015.4月笔记</span><span class="pl__date">Apr 2015</span></a>
        
          <a class="like pl__all" href="/like/2015/04/14/like-orglist.html"><span class="pl__circle"></span><span class="pl__title">喜欢的项目</span><span class="pl__date">Apr 2015</span></a>
        
          <a class="read pl__all" href="/read/2015/04/14/book-2015-04.html"><span class="pl__circle"></span><span class="pl__title">2015.四月 阅读书单</span><span class="pl__date">Apr 2015</span></a>
        
          <a class="about pl__all" href="/about/2015/04/14/about-blogText.html"><span class="pl__circle"></span><span class="pl__title">博客标签测试模板</span><span class="pl__date">Apr 2015</span></a>
        
          <a class="technology pl__all" href="/technology/2015/04/07/blog.html"><span class="pl__circle"></span><span class="pl__title">个人独立博客搭建</span><span class="pl__date">Apr 2015</span></a>
        
          <a class="about pl__all" href="/about/2015/03/08/about-me.html"><span class="pl__circle"></span><span class="pl__title">有关于我</span><span class="pl__date">Mar 2015</span></a>
        
          <a class="technology pl__all" href="/technology/2015/03/08/Android-infrastructure.html"><span class="pl__circle"></span><span class="pl__title">android 程序初期项目设计</span><span class="pl__date">Mar 2015</span></a>
        
          <a class="technology pl__all" href="/technology/2015/03/08/Android-ThreadUtils.html"><span class="pl__circle"></span><span class="pl__title">Android ThreadUtils</span><span class="pl__date">Mar 2015</span></a>
        
          <a class="technology pl__all" href="/technology/2015/03/08/Android-Environment.html"><span class="pl__circle"></span><span class="pl__title">Android Environment</span><span class="pl__date">Mar 2015</span></a>
        
        </nav>
      </div> <!-- end #posts-list -->
    </aside> <!-- end #sidebar -->

    <div id="post">
      <div id="pjax">
        <!--这个页面是喜欢的应用页面 like -->
<article id="post__content">
  <h1 id="post__title" data-identifier="20150308">Android ThreadUtils</h1>
  <h3 id="threadutils">ThreadUtils</h3>

<p>项目中有一些网络访问链接需要请求 每次开一个线程 还要写个handler比较麻烦 就想方便一些
于是就看看能不能写个工具类 将线程和一些可复用性强的东西写下来</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">创建一个类</span> <span class="n">继承Runnadle</span>


<span class="n">基本</span> <span class="n">参数</span>
    <span class="cm">/** handler处理 */</span>
    <span class="kd">private</span> <span class="n">Handler</span> <span class="n">handler</span><span class="o">;</span>
    <span class="cm">/** 网络请求地址 */</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">url</span><span class="o">;</span>
    <span class="cm">/** index */</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">index</span><span class="o">;</span>



   <span class="cm">/**</span>
<span class="cm">     * 构造方法</span>
<span class="cm">     *</span>
<span class="cm">     * @param handler</span>
<span class="cm">     *            消息对象</span>
<span class="cm">     * @param url</span>
<span class="cm">     *            请求的url地址</span>
<span class="cm">	 * @param index</span>
<span class="cm">     *            唯一标示</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="nf">HttpPostThread</span><span class="o">(</span><span class="n">Handler</span> <span class="n">handler</span><span class="o">,</span> <span class="n">String</span> <span class="n">url</span><span class="o">,</span><span class="kt">int</span> <span class="n">index</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">handler</span> <span class="o">=</span> <span class="n">handler</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">url</span> <span class="o">=</span> <span class="n">url</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">index</span> <span class="o">=</span> <span class="n">index</span><span class="o">;</span>
    <span class="o">}</span>


<span class="n">实现run方法</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// 获取我们回调主ui的message</span>
        <span class="n">Message</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="na">obtainMessage</span><span class="o">();</span>
        <span class="k">try</span> <span class="o">{</span>

            <span class="n">Object</span> <span class="n">result</span> <span class="o">=</span> <span class="n">HttpUtil</span><span class="o">.</span><span class="na">doPost</span><span class="o">(</span><span class="n">url</span><span class="o">);/</span><span class="n">访问网络</span>

            <span class="n">msg</span><span class="o">.</span><span class="na">what</span> <span class="o">=</span> <span class="n">ConstantValues</span><span class="o">.</span><span class="na">GET_NET_SUCCEED</span><span class="o">;</span>
            <span class="n">msg</span><span class="o">.</span><span class="na">obj</span> <span class="o">=</span> <span class="n">result</span><span class="o">;</span>
            <span class="n">msg</span><span class="o">.</span><span class="na">arg1</span> <span class="o">=</span> <span class="n">index</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ClientProtocolException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">msg</span><span class="o">.</span><span class="na">what</span> <span class="o">=</span> <span class="mi">404</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">msg</span><span class="o">.</span><span class="na">what</span> <span class="o">=</span> <span class="mi">100</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="c1">// 给主ui发送消息传递数据</span>
        <span class="n">handler</span><span class="o">.</span><span class="na">sendMessage</span><span class="o">(</span><span class="n">msg</span><span class="o">);</span>
    <span class="o">}</span></code></pre></div>

<p>恩基本也就这样了 用的时候</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">String</span> <span class="n">url</span> <span class="o">=</span> <span class="n">getUrl</span><span class="o">();</span>
    <span class="n">ThreadUtils</span> <span class="n">threadutils</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">ThreadUtils</span><span class="o">(</span><span class="n">handler</span><span class="o">,</span> <span class="n">url</span> <span class="o">,</span><span class="n">i</span><span class="o">);</span>
    <span class="k">new</span> <span class="nf">Thread</span><span class="o">(</span><span class="n">ThreadUtils</span><span class="o">).</span><span class="na">start</span><span class="o">();</span></code></pre></div>


</article> <!-- end #post__content -->

<div id="post__share">
  <a id="icon-twitter" class="fontello" href="https://twitter.com/intent/tweet?url=http://zhenchen.me//technology/2015/03/08/Android-ThreadUtils.html&text=Android ThreadUtils" target="_blank"></a>
  <a id="icon-cc" class="fontello" href="http://creativecommons.org/licenses/by-nc-sa/3.0" target="_blank"></a>
  <a id="icon-weibo" class="fontello" href="http://v.t.sina.com.cn/share/share.php?url=http://zhenchen.me//technology/2015/03/08/Android-ThreadUtils.html&title=Android ThreadUtils" target="_blank"></a>
</div> <!-- end #post__share -->

<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'zhangxiaohao'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    

<p id="copyright">Powered by <a href="http://jekyllrb.com" target="_blank">Jekyll</a>&nbsp;&nbsp;|&nbsp;&nbsp;Theme <a href="https://github.com/P233/3-Jekyll" target="_blank">3-Jekyll</a></p>

      </div> <!-- end #pjax -->

      <div id="post__toc-trigger">
        <div id="post__toc">
          <span id="post__toc-title">Table of Contents</span>
          <ul id="post__toc-ul"></ul>
        </div>
      </div>
    </div> <!-- end #post -->

    <button id="js-fullscreen"><span id="icon-arrow" class="fontello"></span></button>

    <script src="/assets/js/jquery-2.0.3.min.js"></script>
    <script src="/assets/js/jquery.pjax.js"></script>
    <script src="/assets/js/nprogress.js"></script>
    <script src="/assets/js/script.js"></script>
    <script type="text/javascript">
    var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
    document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F8df9f41c154d89488e1b1cc18038ab8f' type='text/javascript'%3E%3C/script%3E"));
</script>

  </body>
</html>
